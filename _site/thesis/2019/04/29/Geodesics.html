<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Geodesics on Manifolds</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <head>
<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber:     "all" } } }); </script>
   <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         inlineMath: [ ['$','$'], ["\\(","\\)"] ],
         processEscapes: true
       }
     });
   </script>
     <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"     type="text/javascript"></script>
</head>

  </head>
    <body>
      <header class="site-header">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">MvO</a>
  
    
      <nav class="site-nav">
        <!--<input type="checkbox" id="nav-trigger" class="nav-trigger" />-->
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
            <a class="page-link" href="/about.html">About</a>
            
          
            
            
            <a class="page-link" href="/">Projects</a>
            
          
            
            
          
            
            
            <a class="page-link" href="/thesis.html">Thesis</a>
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>

      <div class="page-content">
        <div class="wrapper">
      <h1>Geodesics on Manifolds</h1>
<p>
  29 Apr 2019
</p>

<p>The discription to approximate the geodesic, using a linear approxiamtion and a quadratic approximation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">".."</span><span class="p">)</span>

<span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
</code></pre></div></div>

<h1 id="computing-of-geodesics-on-a-mesh">Computing of Geodesics on a Mesh</h1>

<p>In this post I will exhibit two way of approximate geodesics between two points. A linear way and a 2nd order approximation. <br />
<strong>Important:</strong> this method is only as good as itâ€™s distance function.</p>

<p>Both these methods requires a distance function, the distance function will be calculated in two different ways, namely the heat method is used as described in <a href="https://www.cs.cmu.edu/~kmcrane/Projects/HeatMethod/">Geodesics in Heat</a>, and the Fast Marching Method as described in <a href="http://www.pnas.org/cgi/doi/10.1073/pnas.95.15.8431">Computing geodesic paths on manifolds</a>.  Geodesics can then be computed using gradient descent. The method does not require a distance function over the entire manifold, in case we only want to find small geodesics. In the linear case the gradient is constant on each triangle, the path is then constructed by finding interections with the edge. A bit more details below.</p>

<p>In the second order approximation, there is a constant transition between the manifold and charts. These charts are 2 dimensional representation of a vertex and its neighbors. In this flat space we find a second order approximation of the distance function, the computed 2 dimensional points are then translated back to the manifold.</p>

<p>In the linear case points are only computed on the edges of faces, while in the second order the path also consists of points on the faces.</p>

<p>The creation of these charts and the translation between the charts and the manifold are done in the <code class="highlighter-rouge">trimesh</code> object. This object consists of additional attributes and functions that could be usefull.</p>

<hr />

<p>Some preliminairy function and packages</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">vtki</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="kn">from</span> <span class="nn">modules.heat_method</span> <span class="kn">import</span> <span class="n">heat_method</span>
<span class="kn">from</span> <span class="nn">modules.fast_marching_method</span> <span class="kn">import</span> <span class="n">FMM</span>
<span class="kn">from</span> <span class="nn">modules.geometry_functions</span> <span class="kn">import</span> <span class="n">discrete_gradient</span>
<span class="kn">from</span> <span class="nn">modules.trimesh</span> <span class="kn">import</span> <span class="n">trimesh</span>

<span class="kn">from</span> <span class="nn">modules.gradient_walk.linear_walk</span> <span class="kn">import</span> <span class="n">LinearWalk</span>
<span class="kn">from</span> <span class="nn">modules.gradient_walk.quadratic_walk</span> <span class="kn">import</span> <span class="n">QuadraticWalk</span>
<span class="kn">from</span> <span class="nn">plyfile</span> <span class="kn">import</span> <span class="n">PlyData</span><span class="p">,</span> <span class="n">PlyElement</span>
<span class="kn">from</span> <span class="nn">vtki</span> <span class="kn">import</span> <span class="n">PolyData</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read_ply</span><span class="p">(</span><span class="n">f_name</span><span class="p">):</span>
    <span class="c"># Read the vertices and triangles from a ply file</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">PlyData</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">f_name</span><span class="p">)</span>
    
    <span class="n">data_vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">'vertex'</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">])</span>
    <span class="n">data_tri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'face'</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">'vertex_indices'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data_vert</span><span class="p">,</span> <span class="n">data_tri</span>

<span class="n">color_map</span> <span class="o">=</span> <span class="s">'prism'</span>
<span class="n">color_point</span> <span class="o">=</span> <span class="s">'black'</span>
<span class="k">def</span> <span class="nf">vtki_plot</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span><span class="n">ind</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">,</span> <span class="n">arrows_tri</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">paths</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">text</span> <span class="o">=</span> <span class="s">''</span><span class="p">,</span> <span class="n">inline</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">show_edges</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
    <span class="c"># Plot functions on the mesh, together with arrows</span>
    <span class="n">polydata</span> <span class="o">=</span> <span class="n">PolyData</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[[</span><span class="mi">3</span><span class="p">]]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">triangles</span><span class="p">),</span><span class="n">mesh</span><span class="o">.</span><span class="n">triangles</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">inline</span><span class="p">:</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="n">vtki</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">notebook</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="n">vtki</span><span class="o">.</span><span class="n">BackgroundPlotter</span><span class="p">()</span>

    <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">show_edges</span> <span class="o">=</span> <span class="n">show_edges</span><span class="p">)</span>
    <span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">pa</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pa</span><span class="p">[</span><span class="s">'points'</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plotter</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">point_size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'black'</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arrows_tri</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">cent</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">mesh</span><span class="o">.</span><span class="n">triangles</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plotter</span><span class="o">.</span><span class="n">add_arrows</span><span class="p">(</span><span class="n">cent</span><span class="p">,</span> <span class="n">arrows_tri</span><span class="p">,</span> <span class="n">mag</span>  <span class="o">=</span> <span class="o">.</span><span class="mo">01</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'g'</span><span class="p">)</span>
    <span class="n">plotter</span><span class="o">.</span><span class="n">view_xy</span><span class="p">()</span>
    <span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    


</code></pre></div></div>

<p>Reading in the data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torus_vert</span><span class="p">,</span> <span class="n">torus_tri</span> <span class="o">=</span> <span class="n">read_ply</span><span class="p">(</span><span class="s">'../test_data/torus_24k.ply'</span><span class="p">)</span>
<span class="n">torus</span> <span class="o">=</span> <span class="n">trimesh</span><span class="p">(</span><span class="n">torus_vert</span><span class="p">,</span> <span class="n">torus_tri</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">arm_vert</span><span class="p">,</span> <span class="n">arm_tri</span> <span class="o">=</span> <span class="n">read_ply</span><span class="p">(</span><span class="s">'../test_data/armadillo_172k.ply'</span><span class="p">)</span>
<span class="n">armadillo</span> <span class="o">=</span> <span class="n">trimesh</span><span class="p">(</span><span class="n">arm_vert</span><span class="p">,</span> <span class="n">arm_tri</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="linear-walk">Linear walk.</h1>

<p>This works using a predefined vector field on the triangles. In the case that the gradient of a vertex is required, the gradients of the adjacend triangles are mapped to the chart around that vertex, then a average is taken of thos vector, the resulting vector is then mapped back to the manifold.</p>

<p>Giving a start point we have a gradient and then we calculate the interection with the opposing edge. The next face has a new gradient which is used to calculate the new point.</p>

<p>A few edge (no pun inteded) cases.</p>
<ul>
  <li>If the new gradient points towards the previous face we walk along the current edge in the directing of the gradient projected on the edge. Similarly when we find ourselves on the boundary.</li>
  <li>If we find an intersection with an edge that is close by an vertex then the next point will be that vertex. Close defined by the <code class="highlighter-rouge">np.allclose()</code> function.</li>
</ul>

<p>We use as stopping criteria the faces around the origin.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Init the heat method</span>
<span class="n">heat_torus</span> <span class="o">=</span> <span class="n">heat_method</span><span class="p">(</span><span class="n">torus_vert</span><span class="p">,</span><span class="n">torus_tri</span><span class="p">)</span>
<span class="n">fmm_torus</span> <span class="o">=</span> <span class="n">FMM</span><span class="p">(</span><span class="n">torus</span><span class="p">)</span>

<span class="c"># Just some points</span>
<span class="n">left_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">torus_vert</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">right_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">torus_vert</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Run the heat method</span>
<span class="n">d_heat</span><span class="p">,</span> <span class="n">X_heat</span> <span class="o">=</span> <span class="n">heat_torus</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">left_ind</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Run the Fast marching, this method takes longer than the heat method.</span>
<span class="n">d_fmm</span> <span class="o">=</span> <span class="n">fmm_torus</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">left_ind</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Lwalk</span> <span class="o">=</span> <span class="n">LinearWalk</span><span class="p">(</span><span class="n">torus</span><span class="p">)</span>
<span class="n">path_heat</span> <span class="o">=</span> <span class="n">Lwalk</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">left_ind</span><span class="p">,</span> <span class="n">right_ind</span><span class="p">,</span> <span class="n">d_heat</span> <span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">d_heat</span><span class="p">))</span>
<span class="n">path_fmm</span> <span class="o">=</span> <span class="n">Lwalk</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">left_ind</span><span class="p">,</span> <span class="n">right_ind</span><span class="p">,</span> <span class="n">d_fmm</span> <span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">d_fmm</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Uncomment this to plot it in a seperate window</span>
<span class="c">#vtki_plot(torus, [left_ind, right_ind], d_fmm, paths = [path_fmm])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotter</span> <span class="o">=</span> <span class="n">vtki</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">polydata</span> <span class="o">=</span> <span class="n">PolyData</span><span class="p">(</span><span class="n">torus_vert</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[[</span><span class="mi">3</span><span class="p">]]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">torus_tri</span><span class="p">),</span><span class="n">torus_tri</span><span class="p">])</span>
<span class="n">color_map</span> <span class="o">=</span> <span class="s">'prism'</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Fast Marching Method'</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d_fmm</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path_fmm</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>


<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Heat Method'</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d_heat</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path_heat</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Fast Marching Method'</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d_fmm</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path_fmm</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-.</span><span class="mi">5</span><span class="p">])</span>


<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Heat Method'</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d_heat</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path_heat</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-.</span><span class="mi">5</span><span class="p">])</span>



<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/geodesics/output_13_0.png" alt="png" /></p>

<p>First of all the paths do not look like they are connected, but that is the plotting program that has an issue. Plotting it in a seperate window makes it better visible. Although the distance function of the heat and fast marching method look similar, they produce different paths. The Fast Marching seems to give a more accurate account, there seems to be a symmetry in the $z$-plance. The heat method is missing this. Granted we are querring a point close to the cut locus. From here it has trouble deciding whether to go left of right of the hole.</p>

<h1 id="quadratic-walk">Quadratic walk</h1>

<p>For a second order walk, which will look smoother, but will be slower to compute.</p>

<p>Given a point on the manifold on a face, one of the three vertices of that face will serve as the origin of that chart. Which point that is is based on a barycentric coordinates. In this chart, the algorithm uses a second order approximation together with Heun iteration method to calculate next points on the path. Checks are made to verify to see when other chart would be better. This method is described in <a href="http://www.pnas.org/cgi/doi/10.1073/pnas.95.15.8431">Computing geodesic paths on manifolds</a> section 5.</p>

<p>A potential downside to this method is that the approximation of the distacne function on a chart has a local minimum, meaning that the found path will not converge to the actual minimum. This approximation might falter when the distance function is not a good estimation of the true distance or when the number of neighbors is too few.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heat_func</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">d_heat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d_heat</span><span class="p">))}</span>
<span class="n">fmm_func</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">d_fmm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d_fmm</span><span class="p">))}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QWalk</span> <span class="o">=</span> <span class="n">QuadraticWalk</span><span class="p">(</span><span class="n">torus</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">time</span>
<span class="n">qpath_heat</span> <span class="o">=</span> <span class="n">QWalk</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">left_ind</span><span class="p">,</span><span class="n">right_ind</span><span class="p">,</span> <span class="n">heat_func</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">d_heat</span><span class="p">),</span> <span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">qpath_fmm</span> <span class="o">=</span> <span class="n">QWalk</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">left_ind</span><span class="p">,</span> <span class="n">right_ind</span><span class="p">,</span> <span class="n">fmm_func</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">d_fmm</span><span class="p">),</span> <span class="n">step_size</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 2.35 s, sys: 228 ms, total: 2.58 s
Wall time: 2.21 s
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#vtki_plot(torus, [left_ind,right_ind], d, paths = [qpath], text = 'both')</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotter</span> <span class="o">=</span> <span class="n">vtki</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">polydata</span> <span class="o">=</span> <span class="n">PolyData</span><span class="p">(</span><span class="n">torus_vert</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[[</span><span class="mi">3</span><span class="p">]]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">torus_tri</span><span class="p">),</span><span class="n">torus_tri</span><span class="p">])</span>
<span class="n">color_map</span> <span class="o">=</span> <span class="s">'prism'</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Fast Marching Method'</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d_fmm</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qpath_fmm</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path_fmm</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'black'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>


<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Heat Method'</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d_heat</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qpath_heat</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path_heat</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'black'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Fast Marching Method'</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d_fmm</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qpath_fmm</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-.</span><span class="mi">5</span><span class="p">])</span>


<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Heat Method'</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d_heat</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qpath_heat</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-.</span><span class="mi">5</span><span class="p">])</span>



<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/geodesics/output_19_0.png" alt="png" /></p>

<p>The paths for the second approximation look kind of similar. The black lines are the linear approximations and the white are the quadratic.</p>

<p>In the FMM case the line passes the hole via the other side, but seems to be a symmetry.</p>

<p>The Heat case the path seems to escape the decision boundary a bit quicker, than the linear case, but not as quick as in the fmm case.</p>

<h1 id="armadillo">Armadillo</h1>

<p>Another example, the armadillo has somewhat more vertices. This example comes from <a href="https://graphics.stanford.edu/data/3Dscanrep/">The Stanford 3D Scanning Repository</a>. The distance function used here is calculated using the heat method as the fast marching method will take too long.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">arm_heat</span> <span class="o">=</span> <span class="n">heat_method</span><span class="p">(</span><span class="n">arm_vert</span><span class="p">,</span> <span class="n">arm_tri</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">arm_vert</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">dest</span> <span class="o">=</span> <span class="mi">2463</span> <span class="c"># some random vertex</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">d</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">arm_heat</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Lwalk</span> <span class="o">=</span> <span class="n">LinearWalk</span><span class="p">(</span><span class="n">armadillo</span><span class="p">)</span>
<span class="n">Qwalk</span> <span class="o">=</span> <span class="n">QuadraticWalk</span><span class="p">(</span><span class="n">armadillo</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">path</span> <span class="o">=</span> <span class="n">Lwalk</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">d</span> <span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">d_func</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">))}</span>
<span class="n">qpath</span> <span class="o">=</span> <span class="n">Qwalk</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span><span class="n">dest</span><span class="p">,</span> <span class="n">d_func</span> <span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#vtki_plot(armadillo,[origin, dest], d, paths = [path, qpath], show_edges = False)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotter</span> <span class="o">=</span> <span class="n">vtki</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">polydata</span> <span class="o">=</span> <span class="n">PolyData</span><span class="p">(</span><span class="n">arm_vert</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[[</span><span class="mi">3</span><span class="p">]]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">arm_tri</span><span class="p">),</span><span class="n">arm_tri</span><span class="p">])</span>
<span class="n">color_map</span> <span class="o">=</span> <span class="s">'prism'</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Heat Linear'</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>


<span class="n">plotter</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s">'Heat Quadratic'</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">polydata</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="n">d</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qpath</span><span class="p">[</span><span class="s">'points'</span><span class="p">]),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">view_vector</span><span class="p">([</span><span class="o">.</span><span class="mo">05</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">],</span> <span class="n">viewup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/geodesics/output_29_0.png" alt="png" /></p>

<p>Again in the big picture you do not see that much of a difference, once you zoom in the differences become apparent.</p>


        </div>
      </div>

    </body>
</html>
